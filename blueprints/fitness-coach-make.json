{
  "name": "Fitness Coach - Make.com",
  "description": "AI fitness coaching bot with vision analysis",
  "version": "1.0",
  "created": "2025-12-08",
  "modules": [
    {
      "id": 1,
      "name": "Telegram Watch Updates",
      "module": "telegram:watchUpdates",
      "note": "Trigger - receives messages from bot"
    },
    {
      "id": 2,
      "name": "Router",
      "module": "builtin:BasicRouter",
      "routes": ["Has Photo", "No Photo"],
      "filter": "{{1.message.photo}} exists"
    },
    {
      "id": 3,
      "name": "Get File Path (Photo route)",
      "module": "http:ActionSendData",
      "method": "GET",
      "url": "https://api.telegram.org/bot{{BOT_TOKEN}}/getFile",
      "qs": "file_id={{1.message.photo[length(1.message.photo)].file_id}}"
    },
    {
      "id": 4,
      "name": "Groq Vision",
      "module": "http:ActionSendData",
      "method": "POST",
      "url": "https://api.groq.com/openai/v1/chat/completions",
      "headers": {
        "Authorization": "Bearer {{GROQ_API_KEY}}",
        "Content-Type": "application/json"
      },
      "body": {
        "model": "meta-llama/llama-4-scout-17b-16e-instruct",
        "messages": [
          {
            "role": "user",
            "content": [
              {
                "type": "text",
                "text": "Analyze food in photo. Return ONLY JSON: {\"description\":\"what's in photo\",\"calories\":123,\"proteins\":\"45g\",\"fats\":\"12g\",\"carbs\":\"67g\",\"tips\":[\"tip\"]}"
              },
              {
                "type": "image_url",
                "image_url": {
                  "url": "https://api.telegram.org/file/bot{{BOT_TOKEN}}/{{3.result.file_path}}"
                }
              }
            ]
          }
        ],
        "max_tokens": 600,
        "temperature": 0.3
      }
    },
    {
      "id": 5,
      "name": "Notion Query Client",
      "module": "http:ActionSendData",
      "method": "POST",
      "url": "https://api.notion.com/v1/databases/{{NOTION_CLIENTS_DB}}/query",
      "headers": {
        "Authorization": "Bearer {{NOTION_API_KEY}}",
        "Notion-Version": "2022-06-28",
        "Content-Type": "application/json"
      },
      "body": {
        "filter": {
          "property": "Telegram_ID",
          "rich_text": {"equals": "{{1.message.chat.id}}"}
        }
      }
    },
    {
      "id": 6,
      "name": "DeepSeek Coach",
      "module": "http:ActionSendData",
      "method": "POST",
      "url": "https://api.deepseek.com/chat/completions",
      "headers": {
        "Authorization": "Bearer {{DEEPSEEK_API_KEY}}",
        "Content-Type": "application/json"
      },
      "body": {
        "model": "deepseek-chat",
        "messages": [
          {
            "role": "system",
            "content": "You are a personal fitness coach. Client: {{5.results[1].properties.Name.title[1].plain_text}}. Weight: {{5.results[1].properties.Current_Weight.number}} kg. Target: {{5.results[1].properties.Target_Weight.number}} kg."
          },
          {
            "role": "user",
            "content": "{{ifempty(4.choices[1].message.content; 1.message.text)}}"
          }
        ],
        "temperature": 0.7,
        "max_tokens": 1000
      }
    },
    {
      "id": 7,
      "name": "Telegram Send with Keyboard",
      "module": "telegram:ActionSendTextMessage",
      "chatId": "{{1.message.chat.id}}",
      "text": "{{6.choices[1].message.content}}",
      "replyMarkup": "custom",
      "keyboard": [
        [{"text": "üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞ –Ω–µ–¥–µ–ª—é"}],
        [{"text": "üçé –í—Å—è –µ–¥–∞"}, {"text": "‚òÄÔ∏è –ó–∞–≤—Ç—Ä–∞–∫–∏"}],
        [{"text": "üå§Ô∏è –û–±–µ–¥—ã"}, {"text": "üåô –£–∂–∏–Ω—ã"}],
        [{"text": "üì• –≠–∫—Å–ø–æ—Ä—Ç –≤ Google –¢–∞–±–ª–∏—Ü—É"}]
      ],
      "resizeKeyboard": true,
      "oneTimeKeyboard": false
    }
  ],
  "credentials": {
    "BOT_TOKEN": "YOUR_TELEGRAM_BOT_TOKEN",
    "GROQ_API_KEY": "YOUR_GROQ_API_KEY",
    "DEEPSEEK_API_KEY": "YOUR_DEEPSEEK_API_KEY",
    "NOTION_API_KEY": "YOUR_NOTION_API_KEY",
    "NOTION_CLIENTS_DB": "YOUR_NOTION_DATABASE_ID"
  },
  "flow_diagram": "Telegram Trigger ‚Üí Router ‚Üí [Photo: GetFile ‚Üí Groq Vision] + [Notion Client] ‚Üí DeepSeek ‚Üí Telegram Reply",
  "setup_steps": [
    "1. Create new scenario in Make.com",
    "2. Add Telegram Watch Updates (connect bot)",
    "3. Add Router with filter: 1.message.photo exists",
    "4. Photo route: HTTP Get File, then HTTP Groq Vision",
    "5. After router: HTTP Notion Query (gets client profile)",
    "6. HTTP DeepSeek (coaching response)",
    "7. Telegram Send Message (with keyboard)",
    "8. Replace placeholders with your credentials",
    "9. Activate and test"
  ]
}
